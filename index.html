<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dispara al Ladrón - Ecuaciones Diferenciales</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>
    </head>
<body>

<div class="container">
    <h1>Dispara al Ladrón: Ecuaciones Diferenciales</h1>
    
    <div id="screen-menu" class="game-screen active">
        <h2>1. SELECCIONA TU MUNDO</h2>
        <div id="world-options">
            <button data-world="TierraAire">Tierra (Con Aire)</button>
            <button data-world="Luna">Luna</button>
            <button data-world="Agua">Agua</button>
            <button data-world="TierraSinAire">Tierra (Sin Aire)</button>
            <button data-world="Jupiter">Júpiter</button>
            <button data-world="Personalizado">Personalizado</button>
        </div>
        <button id="btn-iniciar" disabled>CONFIGURAR VARIABLES</button>
    </div>

    <div id="screen-config" class="game-screen">
        <h2>2. CONFIGURACIÓN DE ESCENARIO</h2>
        
        <label>Masa del objeto (g):</label>
        <input type="number" id="input-masa" value="70" step="1" required><br>
        
        <label>Altura inicial (m):</label>
        <input type="number" id="input-altura" value="100" step="1" required><br>
        
        <label>Velocidad Inicial (m/s):</label>
        <input type="number" id="input-v0" value="0" step="0.1" required><br>

        <h3>Variables del Mundo</h3>
        <label>Gravedad (g):</label>
        <input type="number" id="input-gravedad" value="9.81" step="0.01" disabled><br>
        
        <label>Constante de Resistencia (k):</label>
        <input type="number" id="input-resistencia" value="0.000015" step="0.000001" disabled><br>
        
        <button id="btn-comenzar-juego">COMENZAR PARTIDA</button>
        <button id="btn-volver-menu">Volver al Menú</button>
    </div>

    <div id="screen-game" class="game-screen">
        <h2>Dispara haciendo click en el objetivo para iniciar la caída</h2>
        <canvas id="gameCanvas" width="800" height="600"></canvas>
        
        <div id="data-panel" style="margin-top: 20px; text-align: center;">
            <p>Tiempo Transcurrido: <span id="data-tiempo">0.00 s</span></p>
            <p>Velocidad Actual: <span id="data-velocidad">0.00 m/s</span></p>
            <p>Altura sobre Suelo: <span id="data-altura">0.00 m</span></p>
            <p>Peso (mg): <span id="data-peso">0.00 N</span></p>
        </div>

        <div style="margin-top: 15px; padding: 10px; border: 1px solid #ccc; border-radius: 5px; text-align: center;">
            <h4>Verificación de Velocidad Terminal ($\mathbf{V_T}$):</h4>
            <label>Ingresa tu $V_T$ calculada:</label>
            <input type="number" id="input-vt-usuario" step="0.0001" placeholder="Ej: 8.1429" style="width: 150px;">
            <button id="btn-validar-vt" disabled>Validar</button>
            <p id="vt-resultado" style="font-weight: bold; margin-top: 5px;"></p>
        </div>
        
        <button id="btn-ver-grafico">Ver Gráfico de Análisis (Laplace/RK4)</button>
        <button id="btn-volver-menu">Volver al Menú</button>
    </div>

</div>

<div id="chart-modal" class="modal">
    <div class="modal-content">
        <span class="close" id="close-chart-modal">&times;</span>
        <h3>Gráfico Comparativo de Velocidad $v(t)$</h3>
        <p>Contraste de los modelos de Ecuaciones Diferenciales.</p>
        
        <canvas id="velocityChart"></canvas>
        
        <hr>
        <h4>Demostración del Poder Matemático:</h4>
        <p><strong>Verificación de Laplace:</strong> La curva **Solución Analítica (Laplace)** se superpone al **Modelo Numérico (RK4)**. Esto verifica que nuestro método analítico fue correcto. La Transformada de Laplace nos permitió convertir la EDO lineal en una simple **ecuación algebraica** en el dominio de $s$, demostrando la **elegancia del método** para problemas de valores iniciales.</p>
        
        <p><strong>Análisis Discreto (Transformada Z):</strong> La curva **Modelo Discreto (Euler)** muestra el comportamiento de la solución si se resuelve mediante un método de diferencias finitas, análogo a la **Transformada Z** en sistemas discretos. La diferencia con la curva RK4 (azul) ilustra el error introducido por la discretización.</p>
        
        <p>Este enfoque refleja la evolución histórica de la física matemática, pasando de la aproximación de series a métodos formales poderosos, como los desarrollados por Laplace.</p>
        <hr>
        
        <button id="close-chart-modal-btn">Cerrar</button>
    </div>
</div>

<script src="game.js"></script>

</body>
</html>